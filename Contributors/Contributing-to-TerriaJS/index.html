<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">

	<title>Contributing to TerriaJS - Terria</title>

        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link rel="stylesheet" href="../../css/highlight.css">
        <link href="../../css/base.css" rel="stylesheet">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="../..">Terria</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="../..">Home</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">CatalogManagement <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../CatalogManagement/@Overview/">@Overview</a>
</li>

                    
                        
<li >
    <a href="../../CatalogManagement/CKAN/">CKAN</a>
</li>

                    
                        
<li >
    <a href="../../CatalogManagement/Format-Conversion-Service/">Format Conversion Service</a>
</li>

                    
                        
<li >
    <a href="../../CatalogManagement/GeoJSON/">GeoJSON</a>
</li>

                    
                        
<li >
    <a href="../../CatalogManagement/Handling-CORS/">Handling CORS</a>
</li>

                    
                        
<li >
    <a href="../../CatalogManagement/Initialization-File/">Initialization File</a>
</li>

                    
                        
<li >
    <a href="../../CatalogManagement/Performance-testing/">Performance testing</a>
</li>

                    
                        
<li >
    <a href="../../CatalogManagement/Web-Map-Service/">Web Map Service</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown active">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contributors <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../@Overview/">@Overview</a>
</li>

                    
                        
<li >
    <a href="../CONTRIBUTING/">CONTRIBUTING</a>
</li>

                    
                        
<li class="active">
    <a href="./">Contributing to TerriaJS</a>
</li>

                    
                        
<li >
    <a href="../Development-environment/">Development environment</a>
</li>

                    
                        
<li >
    <a href="../Setting-up-Saucelabs-Locally/">Setting up Saucelabs Locally</a>
</li>

                    
                        
<li >
    <a href="../Using-Docker/">Using Docker</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Customizing <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../Customizing/@Overview/">@Overview</a>
</li>

                    
                        
<li >
    <a href="../../Customizing/CKAN-previewer/">CKAN previewer</a>
</li>

                    
                        
<li >
    <a href="../../Customizing/Config-JSON/">Config JSON</a>
</li>

                    
                        
<li >
    <a href="../../Customizing/Extending-TerriaJS/">Extending TerriaJS</a>
</li>

                    
                        
<li >
    <a href="../../Customizing/How-to-skin-a-Terria-Map/">How to skin a Terria Map</a>
</li>

                    
                        
<li >
    <a href="../../Customizing/TerriaJS-URL-parameters/">TerriaJS URL parameters</a>
</li>

                    
                        
<li >
    <a href="../../Customizing/TerriaJS-in-iframe/">TerriaJS in iframe</a>
</li>

                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Deployment <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        
<li >
    <a href="../../Deployment/@Overview/">@Overview</a>
</li>

                    
                        
<li >
    <a href="../../Deployment/Deploying-Terria-Map/">Deploying Terria Map</a>
</li>

                    
                        
<li >
    <a href="../../Deployment/Deploying-and-building-TerriaJS/">Deploying and building TerriaJS</a>
</li>

                    
                        
<li >
    <a href="../../Deployment/Overall-system-architecture/">Overall system architecture</a>
</li>

                    
                        
<li >
    <a href="../../Deployment/Problems-and-Solutions/">Problems and Solutions</a>
</li>

                    
                        
<li >
    <a href="../../Deployment/Setting-up-a-region-mapping-server/">Setting up a region mapping server</a>
</li>

                    
                        
<li >
    <a href="../../Deployment/Using-a-vector-tile-source-for-region-mapping/">Using a vector tile source for region mapping</a>
</li>

                    
                        
<li >
    <a href="../../Deployment/WMS-Services/">WMS Services</a>
</li>

                    
                    </ul>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                <li >
                    <a rel="next" href="../CONTRIBUTING/">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../Development-environment/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#working-on-terriajs-and-cesium">Working on TerriaJS and Cesium</a></li>
        
    
        <li class="main "><a href="#committing-modifications">Committing modifications</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h2 id="working-on-terriajs-and-cesium">Working on TerriaJS and Cesium</h2>
<p>What if you need to make changes to <a href="https://github.com/AnalyticalGraphicsInc/cesium">Cesium</a> while working on TerriaJS?</p>
<p>In the deployment process, the <a href="https://www.npmjs.com/package/terriajs-cesium">terriajs-cesium package</a> is installed to the <code>node_modules</code> directory by <code>npm install</code>.  Please do not edit Cesium directly in the <code>node_modules</code> directory, because changes will be clobbered the next time you run <code>npm install</code>.  Instead, follow these instructions.</p>
<p>First, set up a Cesium dev environment on your system by following the <a href="https://github.com/AnalyticalGraphicsInc/cesium/wiki/Contributor%27s-Guide">instructions</a>.  Consider checking out TerriaJS/cesium instead of the official Cesium repository on GitHub.  Then, checkout an appropriate version of Cesium.  To use the exact version that Cesium is expecting (assuming you're working in the TerriaJS fork), do:</p>
<pre><code class="bash">cd terriajs
grep terriajs-cesium package.json
# will print something like: &quot;terriajs-cesium&quot;: &quot;0.0.6&quot;
cd ../Cesium
git checkout 0.0.6 # version from above

# Create a new branch to hold your changes.
git checkout -b someBranchName
</code></pre>

<p>If you're planning to upgrade TerriaJS's version of Cesium, you may choose to use the <code>terriajs</code> branch and merge in master from the official Cesium repository, instead of the precise version listed in <code>package.json</code>.</p>
<p>If using the <code>terriajs</code> branch, use gulp task <code>terria-default</code> in order to build Cesium's assets for TerriaJS.</p>
<p>Next, link your local version of Cesium into the global npm package repository:</p>
<pre><code>cd cesium
npm link
</code></pre>

<p>Then, link the now global <code>terriajs-cesium</code> package into National Map:</p>
<pre><code>cd terriajs
npm link terriajs-cesium
</code></pre>

<p>This process essentially makes National Map's <code>node_modules/terriajs-cesium</code> into a symlink to your <code>cesium</code> directory cloned from git.  Any changes you make to Cesium will be automatically picked up by TerriaJS.  Don't forget to run <code>npm install</code> in Cesium after pulling new changes or modifying <code>package.json</code>.  You will also need to build Cesium (by running <code>gulp</code>) if you modify any Cesium shaders or make changes to Cesium code that could affect Cesium's WebWorkers.</p>
<p>To switch TerriaJS back to using the npm version of Cesium, do:</p>
<pre><code>npm unlink terriajs-cesium
npm install
</code></pre>

<h2 id="committing-modifications">Committing modifications</h2>
<p>If you make changes to Cesium and TerriaJS together, here's the process for getting them to production.</p>
<p>First, commit your Cesium changes to a branch and open a pull request to merge that branch to master in the official Cesium repo. Simultaneously, you may want to make a branch of TerriaJS that uses your modified version of Cesium.  To do that, modify TerriaJS's <code>package.json</code>.  Where it has a line like:</p>
<pre><code>&quot;terriajs-cesium&quot;: &quot;^0.0.6&quot;,
</code></pre>

<p>Change it to:</p>
<pre><code>&quot;terriajs-cesium&quot;: &quot;git://github.com/TerriaJS/cesium.git#branchName&quot;,
</code></pre>

<p>Replace <code>branchName</code> with the name of the Cesium branch you want to use.  You may even use a repository other than <code>TerriaJS/cesium</code> if your branch is in a fork of Cesium instead of in the official repository.</p>
<p>Once your Cesium pull request has been merged and a new version of the <code>terriajs-cesium</code> npm module has been published, please remember to update <code>package.json</code> to point to an official <code>terriajs-cesium</code> version instead of a branch in a GitHub repo.</p>
<p>When at all possible, the <code>package.json</code> in the <code>master</code> branch should point to official releases of <code>terriajs-cesium</code> on npm, NOT GitHub branches.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            
            <center>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</center>
        </footer>

        <script src="../../js/jquery-1.10.2.min.js"></script>
        <script src="../../js/bootstrap-3.0.3.min.js"></script>
        <script src="../../js/highlight.pack.js"></script>
        <script>var base_url = '../..';</script>
        <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
        <script src="../../js/base.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                    </div>
                    <div class="modal-body">
                        <p>
                            From here you can search these documents. Enter
                            your search terms below.
                        </p>
                        <form role="form">
                            <div class="form-group">
                                <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                            </div>
                        </form>
                        <div id="mkdocs-search-results"></div>
                    </div>
                    <div class="modal-footer">
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>